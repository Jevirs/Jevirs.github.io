<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="记录了ELK日志分析系统的基本概念与配置">
    

    <!--Author-->
    
        <meta name="author" content="Jevirs">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="ELK入坑配置"/>
    

    <!--Open Graph Description-->
    
        <meta property="og:description" content="记录了ELK日志分析系统的基本概念与配置" />
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="Dare To Win"/>

    <!--Type page-->
    
        <meta property="og:type" content="article" />
    

    <!--Page Cover-->
    

        <meta name="twitter:card" content="summary" />
    

    <!-- Title -->
    
    <title>ELK入坑配置 - Dare To Win</title>

    <!-- Bootstrap Core CSS -->
    <link href="//cdn.bootcss.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet"/>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">

    <!-- Custom Fonts -->
    <link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdn.bootcss.com/featherlight/1.3.5/featherlight.min.js" type="text/css" rel="stylesheet" />

    <!-- Google Analytics -->
    


    <!-- favicon -->
    
    <link rel="icon" href="/images/icon.png">
    
	
</head>


<body>

    <!-- Menu -->
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Jervis's</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                
                    <li>
                        <a href="/">
                            
                                Home
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/archives">
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/about">
                            
                                About
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="https://github.com/Jevirs/Jevirs.github.io">
                            
                                <i class="fa fa-github fa-stack-2x"></i>
                            
                        </a>
                    </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

    <!-- Main Content -->
    <!-- Page Header -->
<!-- Set your background image for this header in your post front-matter: cover -->

<header class="intro-header" style="background-image: url('/images/elastic.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>ELK入坑配置</h1>
                    
                    <span class="meta">
                        <!-- Date and Author -->
                        
                        
                            2015-11-12
                        
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Tags and categories -->
           
                <div class="col-lg-4 col-lg-offset-2 col-md-5 col-md-offset-1 post-tags">
                    
                        


<a href="/tags/code/">#code</a>


                    
                </div>
                <div class="col-lg-4 col-md-5 post-categories">
                    
                </div>
            

            <!-- Gallery -->
            

            <!-- Post Main Content -->
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <h2 id="Logstash"><a href="#Logstash" class="headerlink" title="Logstash"></a>Logstash</h2><h3 id="nginx日志配置"><a href="#nginx日志配置" class="headerlink" title="nginx日志配置"></a>nginx日志配置</h3><ul>
<li>进入conf目录,编辑nginx.conf文件</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/conf/</span><br><span class="line">vim nginx.conf</span><br></pre></td></tr></table></figure>
<ul>
<li>配置nginx日志格式</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//自定义分隔符，方便后续logstash的解析</span><br><span class="line">log_format  main  &quot;$remote_addr | $remote_user | $time_local | $request | $status | $body_bytes_sent | $http_referer | $http_user_agent | $http_x_forwarded_for &quot;;</span><br><span class="line">access_log  logs/access.log  main;</span><br></pre></td></tr></table></figure>
<h3 id="logstash配置"><a href="#logstash配置" class="headerlink" title="logstash配置"></a>logstash配置</h3><ul>
<li>进入logstash文件夹，新建配置文件test.conf</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /opt/logstash</span><br><span class="line">vim test.conf</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">input&#123;</span><br><span class="line">        file&#123;</span><br><span class="line">                path =&gt; &quot;/usr/logs/access.log&quot;</span><br><span class="line">                start_position =&gt; &quot;beginning&quot;</span><br><span class="line">                codec =&gt; json</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">filter &#123;</span><br><span class="line">	ruby &#123;</span><br><span class="line">        init =&gt; &quot;@kname = [&apos;remote_addr&apos;,&apos;remote_user&apos;,&apos;time_local&apos;,&apos;request&apos;,&apos;status&apos;,&apos;body_bytes_sent&apos;,&apos;http_referer&apos;,&apos;http_user_agent&apos;,&apos;http_x_forwarded_for&apos;]&quot;</span><br><span class="line">        code =&gt;&quot;event.append(Hash[@kname.zip(event[&apos;message&apos;].split(&apos; | &apos;))])&quot;</span><br><span class="line">    &#125;</span><br><span class="line">    if [request] &#123;</span><br><span class="line">        ruby &#123;</span><br><span class="line">            init =&gt; &quot;@kname = [&apos;method&apos;,&apos;uri&apos;,&apos;verb&apos;]&quot;</span><br><span class="line">            code =&gt; &quot;event.append(Hash[@kname.zip(event[&apos;request&apos;].split(&apos; &apos;))])&quot;</span><br><span class="line">        &#125;</span><br><span class="line">        if [uri] &#123;</span><br><span class="line">            ruby &#123;</span><br><span class="line">                init =&gt; &quot;@kname = [&apos;url_path&apos;,&apos;url_args&apos;]&quot;</span><br><span class="line">                code =&gt; &quot;event.append(Hash[@kname.zip(event[&apos;request&apos;].split(&apos;?&apos;))])&quot;</span><br><span class="line">            &#125;   </span><br><span class="line">            kv &#123;</span><br><span class="line">                prefix =&gt; &quot;url_&quot;</span><br><span class="line">                source =&gt; &quot;url_args&quot;</span><br><span class="line">                field_split =&gt; &quot;&amp; &quot;</span><br><span class="line">                remove_field =&gt; [ &quot;url_args&quot;,&quot;uri&quot;,&quot;request&quot; ]</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    mutate &#123;</span><br><span class="line">        convert =&gt; [</span><br><span class="line">            &quot;body_bytes_sent&quot; , &quot;integer&quot;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">    date &#123;</span><br><span class="line">        match =&gt; [ &quot;time_local&quot;, &quot;dd/MMM/yyyy:hh:mm:ss Z&quot; ]</span><br><span class="line">        locale =&gt; &quot;en&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">output&#123;</span><br><span class="line">        //stdout用于测试环境输出</span><br><span class="line">        stdout&#123;</span><br><span class="line">            codec =&gt; rubydebug</span><br><span class="line">        &#125;</span><br><span class="line">        //假设elasticsearch在本地开启，若输出到远程服务器，添加配置</span><br><span class="line">        elasticsearch&#123;</span><br><span class="line">            // host =&gt; 127.0.0.2</span><br><span class="line">            // user =&gt; ***</span><br><span class="line">            // password =&gt; ***</span><br><span class="line">            codec =&gt; json</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>启动logstash</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">//检测conf是否通过</span><br><span class="line">bin/logstash -f test.conf --configtest</span><br><span class="line">configation OK</span><br><span class="line">//启动</span><br><span class="line">bin/logstash -f test.conf</span><br><span class="line">/stdout记录输出,并输出到elasticsearch</span><br><span class="line">&#123;</span><br><span class="line">                 <span class="string">"message"</span> =&gt; <span class="string">"127.0.0.1 | - | 11/Nov/2015:13:14:53 +0800 | GET</span></span><br><span class="line"><span class="string">/file/test.img?width=800&amp;height=600 HTTP/1.1 | 404 | 570 | - | Mozilla/5.0 (Wind</span></span><br><span class="line"><span class="string">ows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.80 Sa</span></span><br><span class="line"><span class="string">fari/537.36 | - \r"</span>,</span><br><span class="line">                <span class="string">"@version"</span> =&gt; <span class="string">"1"</span>,</span><br><span class="line">              <span class="string">"@timestamp"</span> =&gt; <span class="string">"2015-11-11T05:14:53.000Z"</span>,</span><br><span class="line">                    <span class="string">"host"</span> =&gt; <span class="string">"Jevirs-PC"</span>,</span><br><span class="line">                    <span class="string">"path"</span> =&gt; <span class="string">"D:\\nginx\\nginx\\logs\\access_test.log"</span>,</span><br><span class="line">             <span class="string">"remote_addr"</span> =&gt; <span class="string">"127.0.0.1"</span>,</span><br><span class="line">             <span class="string">"remote_user"</span> =&gt; <span class="string">"-"</span>,</span><br><span class="line">              <span class="string">"time_local"</span> =&gt; <span class="string">"11/Nov/2015:13:14:53 +0800"</span>,</span><br><span class="line">                  <span class="string">"status"</span> =&gt; <span class="string">"404"</span>,</span><br><span class="line">         <span class="string">"body_bytes_sent"</span> =&gt; 570,</span><br><span class="line">            <span class="string">"http_referer"</span> =&gt; <span class="string">"-"</span>,</span><br><span class="line">         <span class="string">"http_user_agent"</span> =&gt; <span class="string">"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/5</span></span><br><span class="line"><span class="string">37.36 (KHTML, like Gecko) Chrome/46.0.2490.80 Safari/537.36"</span>,</span><br><span class="line">    <span class="string">"http_x_forwarded_for"</span> =&gt; <span class="string">"- \r"</span>,</span><br><span class="line">                  <span class="string">"method"</span> =&gt; <span class="string">"GET"</span>,</span><br><span class="line">                    <span class="string">"verb"</span> =&gt; <span class="string">"HTTP/1.1"</span>,</span><br><span class="line">                <span class="string">"url_path"</span> =&gt; <span class="string">"GET /file/test.img"</span>,</span><br><span class="line">               <span class="string">"url_width"</span> =&gt; <span class="string">"800"</span>,</span><br><span class="line">              <span class="string">"url_height"</span> =&gt; <span class="string">"600"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ElasticSearch"><a href="#ElasticSearch" class="headerlink" title="ElasticSearch"></a>ElasticSearch</h2><h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><ul>
<li><p><strong>节点 (node)</strong>， <strong>集群 (cluster)</strong><br>单台服务器，存储数据并参与集群的索引和搜索，服务器在启动时自动分配<em>ID</em> ，节点默认会加入<em>ID</em>为<em>ElasticSearch</em>的集群中，除非自己配置，如果只有一个节点，那么该节点也作为一个集群工作。<br>多个节点组成的一个集群，集群可跨节点，进行联合索引和搜索。集群默认<em>ID</em>为<em>ElasticSearch</em></p>
</li>
<li><p><strong>索引(index)</strong> ，<strong>类型(type)</strong> ，<strong>文档(document)</strong><br>例:<br>index可为blogSystem；<br>type可为blogs,comments,user；<br>document存储基本信息元；</p>
</li>
<li><p><strong>分片 (shard)</strong> 和 <strong>副本(replica)</strong><br>可为一个索引指定n个分片，分片可以存储在集群中任一个节点上。<br>一个索引默认分配5个分片和一个副本</p>
</li>
</ul>
<h3 id="安装运行"><a href="#安装运行" class="headerlink" title="安装运行"></a>安装运行</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">//普通用户身份操作</span><br><span class="line">curl -L -O https://download.elastic.co/elasticsearch/release/org/elasticsearch/distribution/tar/elasticsearch/2.0.0/elasticsearch-2.0.0.tar.gz</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">tar -xvf elasticsearch-2.0.0.tar.gz</span><br><span class="line"><span class="built_in">cd</span> elasticsearch-2.0.0/bin</span><br><span class="line">./elasticsearch   </span><br><span class="line">...</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>服务占用9200端口，提供对文档操作RESTful API<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">curl -X&lt;REST Verb&gt; &lt;Node&gt;:&lt;Port&gt;/&lt;Index&gt;/&lt;Type&gt;/&lt;ID&gt;</span><br><span class="line">//exp</span><br><span class="line">curl -XGET &apos;localhost:9200/index/type/id?pretty&apos;</span><br><span class="line">curl -XPUT &apos;localhost:9200/index/type/1&apos; -d </span><br><span class="line">&apos;&#123;</span><br><span class="line">  &quot;name&quot;: &quot;John Doe&quot;</span><br><span class="line">&#125;&apos;</span><br><span class="line">curl -XDELETE &apos;localhost:9200/customer&apos;</span><br></pre></td></tr></table></figure></p>
<h3 id="查询语法"><a href="#查询语法" class="headerlink" title="查询语法"></a>查询语法</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">curl -XPOST <span class="string">'localhost:9200/bank/_search?pretty'</span> -d <span class="string">'</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">  "query": &#123; "match-all": &#123; &#125; &#125;,     //所有文档</span></span><br><span class="line"><span class="string">  "query": &#123; "match": &#123; "address": "mill" &#125; &#125;,   //特定文档</span></span><br><span class="line"><span class="string">  "query": &#123; "match": &#123; "address": "aaa bbb" &#125; &#125;, //含有aaa或bbb</span></span><br><span class="line"><span class="string">  "query": &#123; "match_phrase": &#123; "address": "aaa bbb" &#125; &#125;, //含有"aaa bbb"</span></span><br><span class="line"><span class="string">  "size":10,   //记录条数</span></span><br><span class="line"><span class="string">  "from":10,   //记录跳页</span></span><br><span class="line"><span class="string">  "sort": &#123; "balance": &#123; "order": "desc" &#125; &#125;,//排序</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  //与</span></span><br><span class="line"><span class="string">  "query": &#123;</span></span><br><span class="line"><span class="string">    "bool": &#123;</span></span><br><span class="line"><span class="string">      "must": [</span></span><br><span class="line"><span class="string">        &#123; "match": &#123; "address": "mill" &#125; &#125;,</span></span><br><span class="line"><span class="string">        &#123; "match": &#123; "address": "lane" &#125; &#125;</span></span><br><span class="line"><span class="string">      ]</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  &#125;,</span></span><br><span class="line"><span class="string">  //或</span></span><br><span class="line"><span class="string">  "query": &#123;</span></span><br><span class="line"><span class="string">    "bool": &#123;</span></span><br><span class="line"><span class="string">      "should": [</span></span><br><span class="line"><span class="string">        &#123; "match": &#123; "address": "mill" &#125; &#125;,</span></span><br><span class="line"><span class="string">        &#123; "match": &#123; "address": "lane" &#125; &#125;</span></span><br><span class="line"><span class="string">      ]</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  &#125;,</span></span><br><span class="line"><span class="string">  //非</span></span><br><span class="line"><span class="string">  "query": &#123;</span></span><br><span class="line"><span class="string">    "bool": &#123;</span></span><br><span class="line"><span class="string">      "must_not": [</span></span><br><span class="line"><span class="string">        &#123; "match": &#123; "address": "mill" &#125; &#125;,</span></span><br><span class="line"><span class="string">        &#123; "match": &#123; "address": "lane" &#125; &#125;</span></span><br><span class="line"><span class="string">      ]</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  &#125;,</span></span><br><span class="line"><span class="string">  //多条件</span></span><br><span class="line"><span class="string">   "query": &#123;</span></span><br><span class="line"><span class="string">     "bool": &#123;</span></span><br><span class="line"><span class="string">      "must": [</span></span><br><span class="line"><span class="string">        &#123; "match": &#123; "age": "40" &#125; &#125;</span></span><br><span class="line"><span class="string">      ],</span></span><br><span class="line"><span class="string">      "must_not": [</span></span><br><span class="line"><span class="string">        &#123; "match": &#123; "state": "ID" &#125; &#125;</span></span><br><span class="line"><span class="string">      ]</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  &#125;,</span></span><br><span class="line"><span class="string">  //范围选择</span></span><br><span class="line"><span class="string">   "query": &#123;</span></span><br><span class="line"><span class="string">     "bool": &#123;</span></span><br><span class="line"><span class="string">      "must": &#123; "match_all": &#123;&#125; &#125;,</span></span><br><span class="line"><span class="string">      "filter": &#123;</span></span><br><span class="line"><span class="string">        "range": &#123;</span></span><br><span class="line"><span class="string">          "balance": &#123;"gte": 20000,"lte": 30000&#125;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">      &#125;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  &#125;,</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  //排序</span></span><br><span class="line"><span class="string">    "aggs": &#123;</span></span><br><span class="line"><span class="string">    "group_by_state": &#123;</span></span><br><span class="line"><span class="string">      "terms": &#123;</span></span><br><span class="line"><span class="string">        "field": "state"</span></span><br><span class="line"><span class="string">      &#125;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">&#125;'</span></span><br></pre></td></tr></table></figure>
<h2 id="Kibana"><a href="#Kibana" class="headerlink" title="Kibana"></a>Kibana</h2><p>kibana运行于浏览器端，可对数据进行可视化分析</p>
<ul>
<li>下载<a href="https://www.elastic.co/downloads/kibana" target="_blank" rel="noopener">Kibana</a></li>
<li>链接远程elasticsearch:<br>编辑kibana.yml，<code>elasticsearch.url:&quot;http://elasticsearch:9200&quot;</code></li>
<li>解压并启动 <code>./bin/kibana</code></li>
<li>在浏览器端输入<a href="http://localhost:5601" target="_blank" rel="noopener">http://localhost:5601</a></li>
</ul>


                
            </div>

            <!-- Comments -->
            
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    


                </div>
            
        </div>
    </div>
</article>

    <!-- Footer -->
    <hr />

<!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    
                        <li>
                            <a href="https://twitter.com/zhujiawei93" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                        <li>
                            <a href="https://www.facebook.com/james.zhu.338863" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                        <li>
                            <a href="https://github.com/Jevirs/Jevirs.github.io" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    

                    
                        <li>
                            <a href="mailto:z644658982@gmail.com" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-envelope-o fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                </ul>
                <p class="copyright text-muted">&copy; 2018 Jevirs<br></p>
            </div>
        </div>
    </div>
</footer>


    <!-- After footer scripts -->
    
<!-- jQuery -->
<script src="//cdn.bootcss.com/jquery/2.1.4/jquery.min.js"></script>

<!-- Bootstrap -->
<script src="//cdn.bootcss.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

<!-- Gallery -->
<script src="//cdn.bootcss.com/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Disqus Comments -->



</body>

</html>